<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>가변 폰트 사이즈 3D 카드</title>
    <style>
        :root {
            /* 카드의 물리적 크기는 고정 */
            --card-width: 300px;
            --card-height: 450px;
            --fill-color: #70ddff;
            --card-front-bg: #ffffff;
            --card-back-bg: #000000;
            --text-color-back: #ffffff;
        }

        body, html {
            margin: 0; padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #dfe4ea;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        /* 3D 환경 설정 */
        .scene {
            width: var(--card-width);
            height: var(--card-height);
            perspective: 1000px;
        }

        .card {
            width: 100%; height: 100%;
            position: relative;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 20px;
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 20px;
            text-align: center; /* 텍스트가 여러 줄일 경우 중앙 정렬 */
            padding: 20px; /* 내부 여백 */
            box-sizing: border-box; /* 패딩이 크기에 포함되도록 설정 */
            /* 폰트 사이즈는 JS에서 동적으로 설정됩니다. */
        }

        /* 앞면 스타일 */
        .card-front {
            background-color: var(--card-front-bg);
            /* 차오르는 숫자의 글자 크기를 조절하기 위해 폰트 사이즈는 fill-container에 적용됩니다. */
        }

        /* 앞면 숫자 차오르는 레이어 */
        .fill-container {
            position: relative;
            display: inline-block;
            line-height: 1; /* 글자 크기 조정 */
        }
        .base-num {
            color: #eee;
        }
        .fill-num {
            position: absolute;
            top: 0; left: 0;
            color: var(--fill-color);
            width: 100%; height: 100%;
            clip-path: inset(100% 0 0 0);
        }

        /* 뒷면 스타일 */
        .card-back {
            background-color: var(--card-back-bg);
            color: var(--text-color-back);
            transform: rotateY(180deg);
        }
    </style>
</head>
<body>

    <div class="scene">
        <div class="card" id="card">
            <div class="card-face card-front" id="frontFace">
                <div class="fill-container" id="fillContainer">
                    <div class="base-num" id="baseText"></div>
                    <div class="fill-num" id="fillText"></div>
                </div>
            </div>
            <div class="card-face card-back" id="backFace"></div>
        </div>
    </div>

    <script>
        /**
         * 변수 설정: 여기서 내용을 수정하세요.
         * 테스트를 위해 긴 문자열을 넣어보세요!
         */
        const FRONT_NUMBER = '8388608'; // 앞면 내용
        const BACK_CONTENT = 'DENEL20'; // 뒷면 내용

        // DOM 요소 가져오기
        const card = document.getElementById('card');
        const fillContainer = document.getElementById('fillContainer');
        const baseText = document.getElementById('baseText');
        const fillText = document.getElementById('fillText');
        const backFace = document.getElementById('backFace');

        // 텍스트 주입
        baseText.innerText = FRONT_NUMBER;
        fillText.innerText = FRONT_NUMBER;
        backFace.innerText = BACK_CONTENT;

        /**
         * 1. 텍스트 길이에 따라 폰트 크기 조정 함수
         */
        function adjustFontSize(element, content) {
            const length = content.length;
            let fontSize;
            
            // 글자 길이에 따른 대략적인 폰트 크기 설정
            if (length <= 1) {
                fontSize = 150; // '1' 같은 짧은 내용
            } else if (length <= 5) {
                fontSize = 100; // 'Hello' 같은 중간 내용
            } else if (length <= 15) {
                fontSize = 60; // '긴 텍스트 문구'
            } else {
                fontSize = 35; // 매우 긴 텍스트 (글이 작아짐)
            }
            
            // 단위는 'px'로 설정
            element.style.fontSize = `${fontSize}px`;
            
            // 앞면의 경우, fill-container의 폰트 크기를 조절해야 전체가 함께 커집니다.
            if (element === fillContainer) {
                fillContainer.style.fontSize = `${fontSize}px`;
            }
        }

        // 앞면과 뒷면 폰트 크기 조정 적용
        adjustFontSize(fillContainer, FRONT_NUMBER);
        adjustFontSize(backFace, BACK_CONTENT);


        /**
         * 2. 매분 차오르는 부드러운 애니메이션
         */
        function smoothFill() {
            const now = new Date();
            const totalMsPassed = (now.getSeconds() * 1000) + now.getMilliseconds();
            const progress = (totalMsPassed / 60000) * 100;
            fillText.style.clipPath = `inset(${100 - progress}% 0 0 0)`;
            requestAnimationFrame(smoothFill);
        }
        requestAnimationFrame(smoothFill);


        /**
         * 3. 카드 외부 클릭 시 뒤집기 로직
         */
        window.addEventListener('click', (e) => {
            const isClickInside = card.contains(e.target);
            if (!isClickInside) {
                card.classList.toggle('is-flipped');
            }
        });
    </script>
</body>
</html>